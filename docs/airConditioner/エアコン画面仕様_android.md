# エアコン画面仕様書（Android版）

## 概要
トヨタ ハリアー ハイブリッド車のAndroid向けエアコン制御画面UIの詳細仕様

## 画面状態遷移
エアコン画面は以下の3つの状態を持ち、遷移します：

1. **初期表示** (エアコン画面_初期表示) → ユーザーがエアコン設定を確認・調整する画面
2. **リクエスト中** (エアコン画面_リクエスト中) → エアコン起動処理中の画面
3. **完了** (エアコン画面_完了) → エアコン起動完了後の制御画面

## 画面別詳細仕様

### 1. 初期表示画面 (エアコン画面_初期表示)

#### 1.1 ツールバー
**位置**: 画面最上部
**高さ**: 56dp
**背景色**: ダークグレー (#2C2C2E)
**標高**: 4dp

- **左側**: ナビゲーションアイコン（arrow_back、白色、24dp）
- **中央**: 「エアコン」タイトル（白色、18sp、fontWeight = Medium）
- **右側**: ヘルプアイコン（help_outline、白色、24dp）

#### 1.2 設定確認メッセージエリア
**位置**: ツールバー下
**高さ**: 120dp
**背景**: ダークグレー
**パディング**: 16dp

- **メインテキスト**: 「下記の設定でエアコンを起動します。」（白色、16sp）
- **サブテキスト**: 「よろしいですか？」（白色、16sp）
- **textAlign**: Center

#### 1.3 設定表示エリア
**位置**: メッセージエリア下
**高さ**: 150dp
**パディング**: 16dp

##### 1.3.1 設定タイトル行
- **テキスト**: 「エアコンの設定」（白色、18sp、fontWeight = Bold）
- **右側**: 「変更する」TextButton（赤色、14sp）
- **レイアウト**: Row（SpaceBetween）

##### 1.3.2 起動時間表示
**背景**: Card（cornersRadius = 8dp、標高 = 2dp）
**パディング**: 16dp
- **ラベル**: 「起動時間」（薄いグレー、14sp）
- **数値**: 「10」（白色、36sp、fontWeight = ExtraBold）
- **単位**: 「分間」（薄いグレー、18sp）
- **レイアウト**: Column（CenterHorizontally）

#### 1.4 実行ボタンエリア
**位置**: 画面下部
**高さ**: 80dp
**パディング**: 16dp

- **ボタン**: 「この設定で起動する」Button
- **サイズ**: fillMaxWidth、高さ48dp
- **背景色**: 赤色 (#FF3B30)
- **テキスト色**: 白色
- **フォントサイズ**: 16sp、fontWeight = Bold
- **shape**: RoundedCornerShape(8dp)

### 2. リクエスト中画面 (エアコン画面_リクエスト中)

#### 2.1 ツールバー
- 初期表示と同様のツールバー構成

#### 2.2 リクエスト状態エリア
**位置**: 画面中央
**高さ**: 200dp

##### 2.2.1 リクエスト表示
- **メインテキスト**: 「リクエスト中」（白色、18sp、fontWeight = Medium）
- **ローディングアニメーション**: CircularProgressIndicator
  - **サイズ**: 64dp
  - **色**: 赤色 (#FF3B30)
  - **strokeWidth**: 4dp

#### 2.3 動作設定表示エリア
**位置**: ローディング下
**高さ**: 120dp

- **タイトル**: 「この設定で動作中」（白色、16sp）
- **起動時間表示**:
  - ラベル: 「起動時間」（薄いグレー、14sp）
  - 数値: 「10」（白色、24sp、fontWeight = Bold）
  - 単位: 「分間」（薄いグレー、16sp）

#### 2.4 停止ボタンエリア
**位置**: 画面下部

- **ボタン**: 「停止する」Button
- **サイズ**: width = 0.7f、高さ48dp
- **背景色**: グレー (#3C3C3E) - 非アクティブ状態
- **テキスト色**: 白色
- **enabled**: false（リクエスト中は無効）

#### 2.5 通知設定エリア
**位置**: 停止ボタン下
- 初期表示と同じ通知設定エリア

### 3. 完了画面 (エアコン画面_完了)

#### 3.1 ツールバー
- 初期表示と同様のツールバー構成

#### 3.2 完了ステータスエリア
**位置**: 画面中央上部
**高さ**: 180dp

##### 3.2.1 完了表示
- **メインテキスト**: 「エアコン停止まで」（白色、16sp）
- **カウントダウン**: 「9」（白色、72sp、fontWeight = ExtraBold）
- **単位**: 「分」（白色、24sp）
- **レイアウト**: Column（CenterHorizontally）

#### 3.3 動作中設定表示エリア
**位置**: カウントダウン下
**高さ**: 120dp

- **タイトル**: 「この設定で動作中」（白色、16sp）
- **起動時間表示**:
  - ラベル: 「起動時間」（薄いグレー、14sp）
  - 数値: 「10」（白色、24sp、fontWeight = Bold）
  - 単位: 「分間」（薄いグレー、16sp）

#### 3.4 停止ボタンエリア
**位置**: 画面中央下

- **ボタン**: 「停止する」Button
- **サイズ**: width = 0.7f、高さ48dp
- **背景色**: 赤色 (#FF3B30)
- **テキスト色**: 白色
- **フォントサイズ**: 16sp、fontWeight = Bold
- **shape**: RoundedCornerShape(8dp)

#### 3.5 通知設定エリア
**位置**: 停止ボタン下
**高さ**: 120dp
**背景色**: 少し明るいダークグレー (#1C1C1E)
**shape**: RoundedCornerShape(8dp)
**パディング**: 16dp

- **タイトル**: 「通知設定」（白色、16sp、fontWeight = Bold）
- **説明文**: 「クルマの操作関連通知をONにすると、リモート操作完了時にお知らせします。」（薄いグレー、12sp）
- **設定ボタン**: 
  - アイコン: settings（Materialアイコン、24dp）
  - テキスト: 「アプリの通知を設定する」（白色、14sp）
  - レイアウト: Row（CenterVertically）

## 画面遷移仕様

### 遷移パターン
1. **ホーム画面 → 初期表示**: エアコンボタンタップでスライド遷移
2. **初期表示 → リクエスト中**: 「この設定で起動する」ボタンタップで即座に遷移
3. **リクエスト中 → 完了**: API応答成功でフェード遷移
4. **完了 → 初期表示**: 「停止する」ボタンタップ
5. **任意画面 → ホーム画面**: 戻るボタンタップで戻る

### アニメーション
- **スライド遷移**: slideInHorizontally/slideOutHorizontally（300ms）
- **フェード遷移**: fadeIn/fadeOut（500ms）
- **状態変更**: crossfade（500ms）

## カラーパレット

| 要素 | カラーコード | Material Design Token |
|------|-------------|----------------------|
| 背景色 | #000000 | surface |
| ダークグレー | #2C2C2E | surfaceVariant |
| ライトグレー | #3C3C3E | surfaceContainer |
| 通知背景 | #1C1C1E | surfaceContainerHigh |
| 白色 | #FFFFFF | onSurface |
| 薄いグレー | #8E8E93 | onSurfaceVariant |
| 赤色 | #FF3B30 | error |

## フォント仕様（Android）

| 要素 | フォントサイズ | 太さ | Material Typography |
|------|---------------|------|-------------------|
| ツールバータイトル | 18sp | Medium | titleLarge |
| メインテキスト | 16sp | Normal | bodyLarge |
| カウントダウン数値（大） | 72sp | ExtraBold | displayLarge |
| 時間数値（中） | 36sp | ExtraBold | headlineLarge |
| 時間数値（小） | 24sp | Bold | headlineSmall |
| ボタンテキスト | 16sp | Bold | labelLarge |
| ラベル | 14sp | Normal | bodyMedium |
| 説明文 | 12sp | Normal | bodySmall |

## インタラクション仕様

### タップ可能要素
1. ナビゲーションアイコン（戻る）
2. ヘルプアイコン
3. 「変更する」TextButton
4. 「この設定で起動する」Button
5. 「停止する」Button
6. 「アプリの通知を設定する」Button

### フィードバック
- **タップ時**: HapticFeedbackType.LightImpact
- **ボタン押下時**: Ripple効果（300ms）
- **状態遷移時**: フェードアニメーション

## ローディング・アニメーション仕様

### リクエスト中アニメーション
- **CircularProgressIndicator**: 回転アニメーション（無限ループ）
- **アニメーション速度**: 1秒/回転

### カウントダウン
- **更新間隔**: 1秒毎
- **アニメーション**: animateIntAsState で数字変更時にスムーズな変化

## エラーハンドリング

### 通信エラー時
- **SnackBar表示**: 「通信エラーが発生しました。しばらく時間をおいて再度お試しください。」
- **アクション**: 「再試行」ボタン付き
- **自動遷移**: 初期表示画面に戻る

### タイムアウト時
- **SnackBar表示**: 「処理がタイムアウトしました。」
- **自動遷移**: 初期表示画面に戻る

## アクセシビリティ

### TalkBack対応
- 全ボタンに適切なcontentDescription設定
- カウントダウンの音声読み上げ対応
- 状態変更時のアナウンス
- semantics {} ブロックでの詳細設定

### Dynamic Type対応
- スケーラブルなフォントサイズ設定（sp単位）
- テキスト拡大時のレイアウト調整
- 最小・最大サイズ制限

## Android固有仕様

### 権限
- 通知権限（Android 13以降）

### ライフサイクル対応
- **onPause**: タイマー一時停止
- **onResume**: タイマー再開
- **onDestroy**: リソース解放

### バックグラウンド処理
- **フォアグラウンドサービス**: エアコン動作中の継続処理
- **通知**: 操作完了時の通知表示

### State管理
- **remember**: 一時的な状態
- **rememberSaveable**: 構成変更を跨ぐ状態
- **ViewModel**: ビジネスロジック

## パフォーマンス要件

### 応答性能
- ボタンタップ応答: 100ms以内
- 画面遷移: 300ms以内
- API通信タイムアウト: 30秒

### メモリ使用量
- メモリリーク防止
- 適切なCompose再コンポーズ制御
- 不要なオブジェクト生成抑制

---

**作成日**: 2024年12月19日  
**バージョン**: 1.0  
**最終更新**: 2024年12月19日
**ベース仕様**: エアコン画面仕様書（iOS版）v1.0
