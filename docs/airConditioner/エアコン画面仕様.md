# エアコン画面仕様書

## 概要
エアコンの制御を行う画面の仕様書です。ホーム画面のエアコンボタンからプッシュ遷移で表示されます。

## 画面状態
エアコン画面は以下の3つの状態を持ちます：

1. **初期表示** - エアコン設定の確認画面
2. **リクエスト中** - エアコン起動処理中の表示
3. **完了** - エアコン起動完了後の制御画面

## 画面遷移フロー

```
ホーム画面 → エアコン画面（初期表示）
                ↓ 「この設定で起動する」ボタン押下
            エアコン画面（リクエスト中）
                ↓ 数秒後（自動遷移）
            エアコン画面（完了）
                ↓ 「停止する」ボタン押下
            エアコン画面（初期表示）に戻る
```

---

## 1. 初期表示画面

### レイアウト構造

#### ヘッダー部
- **位置**: 画面上部
- **背景色**: ダークネイビー（#1a1a2e）
- **高さ**: 64dp/pt
- **要素**:
  - 戻るボタン（左端）: 白色の左向き矢印アイコン
  - タイトル「エアコン」: 中央配置、白色テキスト、フォントサイズ18sp/pt
  - ヘルプボタン（右端）: 白色の「?」アイコン

#### メインコンテンツ部
- **背景色**: ダークネイビー（#1a1a2e）

##### セクション1: 説明テキスト
- **位置**: ヘッダー下、上部マージン24dp/pt
- **テキスト**: 
  ```
  下記の設定でエアコンを起動します。
  よろしいですか？
  ```
- **スタイル**: 白色テキスト、フォントサイズ16sp/pt、行間1.5
- **配置**: 左右マージン24dp/pt

##### セクション2: 設定表示エリア
- **位置**: 説明テキスト下、上部マージン32dp/pt
- **背景**: 透明
- **境界線**: 上下に薄いグレー線（#333333）

###### 設定ヘッダー
- **テキスト**: 「エアコンの設定」
- **スタイル**: 白色テキスト、フォントサイズ18sp/pt、太字
- **右端**: 「変更する」リンク（赤色テキスト #ff4444）
- **マージン**: 上下16dp/pt、左右24dp/pt

###### 起動時間表示
- **ラベル**: 「起動時間」（グレーテキスト #888888、フォントサイズ14sp/pt）
- **値**: 「10分間」（白色テキスト、フォントサイズ32sp/pt、太字）
- **配置**: 中央揃え
- **マージン**: 上部24dp/pt、下部32dp/pt

##### セクション3: アクションボタン
- **位置**: 画面下部、下部マージン32dp/pt
- **ボタンスタイル**:
  - 背景色: 赤色（#ff4444）
  - テキスト: 「この設定で起動する」
  - テキスト色: 白色
  - フォントサイズ: 16sp/pt、太字
  - 高さ: 48dp/pt
  - 角丸: 8dp/pt
  - 左右マージン: 24dp/pt

### ユーザーインタラクション
- **戻るボタン**: タップでホーム画面に戻る
- **ヘルプボタン**: タップでヘルプ画面表示
- **「変更する」リンク**: タップで設定変更画面表示
- **「この設定で起動する」ボタン**: タップでリクエスト中画面に遷移

---

## 2. リクエスト中画面

### レイアウト構造

#### ヘッダー部
- 初期表示画面と同様の構造
- ヘルプボタンは非表示

#### メインコンテンツ部
- **背景色**: ダークネイビー（#1a1a2e）

##### セクション1: ステータス表示
- **位置**: 画面上部中央、ヘッダー下マージン48dp/pt
- **テキスト**: 「リクエスト中」
- **スタイル**: 白色テキスト、フォントサイズ18sp/pt
- **配置**: 中央揃え

##### セクション2: ローディングインジケーター
- **位置**: ステータステキスト下、マージン24dp/pt
- **要素**: 回転するスピナー（赤色 #ff4444）
- **サイズ**: 48dp/pt × 48dp/pt
- **配置**: 中央揃え
- **アニメーション**: 連続回転（1秒間隔）

##### セクション3: 区切り線
- **位置**: ローディング下、マージン48dp/pt
- **スタイル**: 薄いグレー線（#333333）、左右マージン24dp/pt

##### セクション4: 動作中設定表示
- **テキスト**: 「この設定で動作中」（グレーテキスト #888888、フォントサイズ14sp/pt）
- **位置**: 区切り線下、マージン24dp/pt
- **配置**: 中央揃え

##### セクション5: 起動時間表示
- **ラベル**: 「起動時間」（グレーテキスト #888888、フォントサイズ14sp/pt）
- **値**: 「-- --」（白色テキスト、フォントサイズ32sp/pt）
- **配置**: 中央揃え
- **マージン**: 上部16dp/pt

##### セクション6: 停止ボタン
- **位置**: 画面下部、下部マージン32dp/pt
- **ボタンスタイル**:
  - 背景色: グレー（#666666）
  - テキスト: 「停止する」
  - テキスト色: 白色
  - フォントサイズ: 16sp/pt
  - 高さ: 48dp/pt
  - 角丸: 8dp/pt
  - 左右マージン: 24dp/pt
  - 状態: 無効化（タップ不可）

##### セクション7: 通知設定エリア
- **位置**: 画面下部
- **背景色**: 濃いグレー（#2a2a3e）
- **角丸**: 上部のみ16dp/pt
- **パディング**: 24dp/pt

###### 通知設定ヘッダー
- **テキスト**: 「通知設定」（白色、フォントサイズ18sp/pt、太字）

###### 通知説明テキスト
- **テキスト**: 「クルマの操作関連通知をONにすると、リモート操作完了時にお知らせします。」
- **スタイル**: グレーテキスト（#cccccc）、フォントサイズ14sp/pt、行間1.4
- **マージン**: 上部8dp/pt

###### 通知設定ボタン
- **テキスト**: 「⚙️ アプリの通知を設定する」
- **スタイル**: 白色テキスト、フォントサイズ16sp/pt
- **配置**: 左揃え
- **マージン**: 上部16dp/pt

### 表示時間とアニメーション
- **表示時間**: 3-5秒間
- **自動遷移**: 完了画面へ自動遷移
- **ローディングアニメーション**: 連続回転

---

## 3. 完了画面

### レイアウト構造

#### ヘッダー部
- 初期表示画面と同様の構造

#### メインコンテンツ部
- **背景色**: ダークネイビー（#1a1a2e）

##### セクション1: ステータス表示
- **位置**: 画面上部中央、ヘッダー下マージン48dp/pt
- **テキスト**: 「エアコン停止まで」
- **スタイル**: 白色テキスト、フォントサイズ18sp/pt
- **配置**: 中央揃え

##### セクション2: 残り時間表示
- **位置**: ステータステキスト下、マージン24dp/pt
- **値**: 「9分」（白色テキスト、フォントサイズ64sp/pt、太字）
- **配置**: 中央揃え

##### セクション3: 区切り線
- **位置**: 残り時間下、マージン48dp/pt
- **スタイル**: 薄いグレー線（#333333）、左右マージン24dp/pt

##### セクション4: 動作中設定表示
- **テキスト**: 「この設定で動作中」（グレーテキスト #888888、フォントサイズ14sp/pt）
- **位置**: 区切り線下、マージン24dp/pt
- **配置**: 中央揃え

##### セクション5: 起動時間表示
- **ラベル**: 「起動時間」（グレーテキスト #888888、フォントサイズ14sp/pt）
- **値**: 「10分間」（白色テキスト、フォントサイズ32sp/pt）
- **配置**: 中央揃え
- **マージン**: 上部16dp/pt

##### セクション6: 停止ボタン
- **位置**: 画面中央下部、マージン32dp/pt
- **ボタンスタイル**:
  - 背景色: 赤色（#ff4444）
  - テキスト: 「停止する」
  - テキスト色: 白色
  - フォントサイズ: 16sp/pt、太字
  - 高さ: 48dp/pt
  - 角丸: 8dp/pt
  - 左右マージン: 24dp/pt

##### セクション7: 通知設定エリア
- リクエスト中画面と同様の構造

### ユーザーインタラクション
- **戻るボタン**: タップでホーム画面に戻る
- **ヘルプボタン**: タップでヘルプ画面表示
- **「停止する」ボタン**: タップで初期表示画面に戻る
- **通知設定ボタン**: タップで通知設定画面表示

### リアルタイム更新
- **残り時間**: 1分間隔で更新（9分 → 8分 → 7分...）
- **自動停止**: 残り時間が0になったら初期表示画面に自動遷移

---

## 共通仕様

### カラーパレット
- **プライマリ背景**: ダークネイビー（#1a1a2e）
- **セカンダリ背景**: 濃いグレー（#2a2a3e）
- **アクセントカラー**: 赤色（#ff4444）
- **プライマリテキスト**: 白色（#ffffff）
- **セカンダリテキスト**: グレー（#888888）
- **境界線**: 薄いグレー（#333333）

### フォント仕様
- **大見出し**: 64sp/pt、太字
- **中見出し**: 32sp/pt、太字
- **小見出し**: 18sp/pt、太字
- **本文**: 16sp/pt、通常
- **キャプション**: 14sp/pt、通常

### アニメーション仕様
- **画面遷移**: プッシュアニメーション（0.3秒）
- **ローディング**: 回転アニメーション（連続、1秒間隔）
- **ボタンタップ**: スケールアニメーション（0.1秒）

### レスポンシブ対応
- **最小幅**: 320dp/pt
- **最大幅**: 768dp/pt
- **マージン調整**: 画面幅に応じて16-32dp/ptの範囲で調整

### アクセシビリティ
- **音声読み上げ**: すべてのテキストとボタンに対応
- **コントラスト比**: WCAG AA準拠（4.5:1以上）
- **フォーカス表示**: キーボードナビゲーション対応

### プラットフォーム固有仕様

#### Android固有実装
- **ステータスバー**: システムバーの色をダークネイビーに設定
- **ナビゲーションバー**: システムナビゲーションバーの色を背景色に合わせる
- **戻るボタン**: システムの戻るボタンでもホーム画面に戻る動作

#### iOS固有実装
- **セーフエリア**: iPhone X以降のノッチ・ホームインジケーター対応
- **ステータスバー**: ライトコンテンツスタイル設定
- **スワイプジェスチャー**: 画面端からのスワイプで戻る動作対応

### エラーハンドリング
- **ネットワークエラー**: エラーダイアログ表示後、初期表示画面に戻る
- **タイムアウト**: 30秒でタイムアウト、エラーダイアログ表示
- **サーバーエラー**: エラーメッセージ表示後、初期表示画面に戻る

### パフォーマンス要件
- **画面遷移時間**: 300ms以内
- **レスポンス時間**: ボタンタップから反応まで100ms以内
- **メモリ使用量**: 50MB以内

---

## 実装時の注意点

1. **状態管理**: 各画面状態を適切に管理し、予期しない遷移を防ぐ
2. **タイマー処理**: バックグラウンド時もタイマーが正常動作するよう実装
3. **通信処理**: 非同期処理でUIブロックを防ぐ
4. **メモリリーク**: タイマーやリスナーの適切な解放
5. **ユーザビリティ**: ローディング中の操作制限とフィードバック

この仕様書は、Android・iOS両プラットフォームで一貫したユーザー体験を提供するための詳細な設計指針です。
